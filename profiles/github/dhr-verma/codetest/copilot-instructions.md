# Copilot Instructions

## Project Overview

This is a **distribution repo** — not a typical application. It deploys Claude Code configuration (permissions, instructions, skills) into GitHub Codespaces via a `curl | bash` one-liner added to consuming repos' `devcontainer.json`. The repo structure mirrors the deployed `.claude/` directory exactly.

## Architecture

- **`setup-ai-assistant.sh`** — The entry point. Downloaded and piped to bash by consuming repos. Installs Claude Code, then deploys config files from this repo using raw GitHub URLs.
- **`.claude/settings.json`** — Permissions config using `bypassPermissions` mode with an explicit deny list. Always overwrites on deploy.
- **`.claude/CLAUDE.md`** — Default project instructions template. Only deployed if the consuming repo doesn't already have one (no-clobber).
- **`.claude/commands/*.md`** — Slash commands (`/review`, `/test-gen`, `/types`) for Claude Code.
- **`.claude/hooks/`** — Post-save hook definitions.
- **`.claude/skills/`** — Skill manifests and skill definitions (e.g., `reviewer/SKILL.md`). Default skills are listed in `skills/skills.md` manifest.
- **`.github/workflows/`** — Agentic workflows (`gh-aw`) for automated code quality (code-simplifier, duplicate-code-detector, daily-repo-status). These are compiled from `.md` definitions using `gh aw compile`.

## Key Conventions

- **Idempotent deployment**: The setup script must be safe to run multiple times. `settings.json` and skills always overwrite; `CLAUDE.md` uses no-clobber semantics.
- **No git/gh dependency**: The setup script uses only `curl` for fetching — no `git clone` or `gh` CLI required in the target environment.
- **Config sourcing**: All remote files are fetched from `https://raw.githubusercontent.com/${CLAUDE_SETUP_REPO}/${CLAUDE_SETUP_REF}/...`. The repo/ref are configurable via `CLAUDE_SETUP_REPO` and `CLAUDE_SETUP_REF` environment variables.
- **Skills manifest**: Default skills are listed line-by-line in `.claude/skills/skills.md`. Each skill is a directory under `.claude/skills/` containing a `SKILL.md` file. Additional skills can be passed as CLI arguments to the setup script.
- **Agentic workflows**: Workflow `.md` files under `.github/workflows/` are the source of truth. Lock files (`.lock.yml`) are auto-generated by `gh aw compile` — do not edit them directly.
- **Shell scripting**: The setup script uses `bash` with `set -euo pipefail`. Failures in optional steps (curl downloads, skill installs) are tolerated with `|| true`.
